Bootstrap: docker
From: ubuntu:20.04

%post
    export DEBIAN_FRONTEND=noninteractive
    apt-get update
    apt-get install -y python3 python3-pip \
                       libjpeg-dev zlib1g-dev

    python3 -m pip install --upgrade pip

    pip install numpy pandas scikit-learn matplotlib

    # PyTorch for Python 3.8 (CUDA 11.8)
    pip install torch==2.1.2+cu118 torchvision==0.16.2+cu118 torchaudio==2.1.2 \
        --extra-index-url https://download.pytorch.org/whl/cu118

    # Hugging Face + Pillow (JPEG support will now be enabled)
    pip install transformers pillow requests

%environment
    # Ensure pip-installed binaries are in PATH
    export PATH=/usr/local/bin:$PATH

%test
    python3 --version
    python3 -c "import torch; \
                print('PyTorch:', torch.__version__); \
                print('CUDA available:', torch.cuda.is_available()); \
                print('GPU:', torch.cuda.get_device_name(0) if torch.cuda.is_available() else 'None')"

